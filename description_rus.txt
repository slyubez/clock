Это открытый проект часов на базе схемотехники Arduino.
Исходные коды доступны по адресу https://github.com/slyubez/clock
Электрическая схема будет позже нарисована в KiCad и выложена в
тот же репозиторий. Схема, программное обеспечение и плата могут
использоваться без выплаты автору вознаграждения.

Автор - Сергей Любезный, г. Москва, E-mail slyubez@gmail.com

Используемые узлы и элементы:
1. Четыре светодиодных семисегментных индикатора Foryard FYS-40011BUG-11 с
управлением транзисторными ключами. Используется динамическая индикация.
Возможно использование сборки из индикаторов. В данном случае используются
индикаторы с общим анодом. Взамен вышеуказанной марки можно также использовать
индикаторы Kingbright SA40-18RWA, при условии пересчета номиналов резисторов
на транзисторных ключах. Одноименные сегменты индикаторов соединены параллельно
и подключены через сегментные однотранзисторные ключи на базе транзисторов
2N3904. Общие аноды индикаторов соединяются с индикаторными транзисторными
ключами, собранными каждый на двух транзисторах 2N3904 и 2N4403. На втором 
индикаторе используется десятичная точка, подключаемая через отдельный
сегментный ключ. Активный входной уровень всех ключей - высокий.
2. Микроконтроллер AtMega 328P-PU с внешним кварцевым резонатором 16 МГц
и с прошитым загрузчиком Arduino Uno.
3. Четыре управляющих нормально разомкнутых кнопки, подключенных между
аналоговыми входами микроконтроллера и землей. Эти аналоговые входы
используются как цифровые и подтянуты к шине питания +5В через резисторы
номиналом 10 килоом.
4. Любая совместимая с Arduino плата часов реального времени. Вначале была
применена плата Troyka RTC производства компании Амперка на базе чипа DS1307.
Однако часы, собранные на ней, имели отклонения в точности хода до 10 секунд
за сутки. По этой причине плата была заменена на другую, производства Китая,
на базе высокоточного чипа RTC DS3231; при этом не понадобилось менять ни код,
ни используемую библиотеку от Амперки. Библиотека Arduino для работы с этими
платами выложена по адресу https://github.com/amperka/TroykaRTC . Описание платы
Troyka RTC на русском языке имеется на сайте производителя по ссылке:
http://amperka.ru/product/troyka-rtc
5. Схема питания. Общее питание схемы осуществляется от постоянного тока
напряжением 12В. Общее потребление тока составляет около 150мА. Индикаторы 
запитаны от 12В через ключи и ограничительные резисторы. Также внутри 
схемы присутствует стабилизатор напряжения 7805, через который питается 
микроконтроллер, и к которому подтягиваются входы микроконтроллера через 
резисторы.

Комментарий по коду программы часов.
Программа написана на диалекте языка C++ для оборудования Arduino.
Использована технология Model-View-Controller. Представление (View.cpp) отвечает
за вывод информации на семисегментные индикаторы. Контроллеров используется
три: контроллер часов реального времени, контроллер кнопок и контроллер EEPROM.
Логика работы часов полностью реализована в модели (файл Model.cpp).
Инициализация представления и контроллеров происходит при инициализации модели.
В программе реализован ряд режимов отображения времени, даты, поправочного
кожффициента. Отображение всех параметров осуществляется в бесконечном цикле,
внутри которого вызывается метод model.run . В этом методе сначала считывается
текущее время из часов реального времени. Затем в зависимости от режима отображения
отрабатывается реакция на нажатие кнопок, если оно имело место. Далее методами 
_view.setDigit, _view.turnOnDecimalPoint и _view.turnOffDecimalPoint задаются 
значения цифр всех индикаторов и десятичной точки второго индикатора, после чего 
вызывается метод _view.showDigits, внутри которого осуществляется поочередная
выдача сигналов на набор сегментов каждой цифры и каждый из соответствующих
индикаторных ключей с заданной задержкой после подачи питания на индикаторный ключ.
